# Wallet Service

## Описание

Wallet Service — это приложение для управления кошельками пользователей. Оно позволяет пользователям создавать кошельки, просматривать баланс и выполнять операции пополнения и снятия средств. Приложение использует Spring Boot для создания RESTful API и Spring Security для управления авторизацией и аутентификацией.

## Технологии

- **Spring Boot**: Фреймворк для создания RESTful API.
- **Spring Security**: Фреймворк для управления авторизацией и аутентификацией.
- **Spring Data JPA**: Фреймворк для работы с базой данных.
- **PostgreSQL**: База данных для хранения информации о пользователях и кошельках.
- **Liquibase**: Инструмент для управления миграциями базы данных.
- **JUnit 5**: Фреймворк для написания и выполнения тестов.
- **Mockito**: Фреймворк для создания мок-объектов в тестах.
- **Docker**: Платформа для контейнеризации приложений.

## Реализованные функции

### 1. Управление пользователями

- **Аутентификация и авторизация**: Использование Spring Security для управления доступом к ресурсам на основе ролей пользователей.
- **Тестировать приложение можно с помощью пользователей admin/password ; user/password**

### 2. Управление кошельками

- **Просмотр баланса**: Пользователи могут просматривать баланс своих кошельков.
- **Операции пополнения и снятия средств**: Пользователи могут выполнять операции пополнения и снятия средств с кошелька.

### 3. Безопасность

- **Аутентификация**: Использование Basic Authentication для аутентификации пользователей.
- **Авторизация**: Использование аннотаций `@PreAuthorize` для управления доступом к ресурсам на основе ролей пользователей.

### 4. Тестирование

- **Юнит-тесты**: Использование JUnit 5 и Mockito для написания и выполнения тестов.
- **Интеграционные тесты**: Использование Spring Boot Test для написания и выполнения интеграционных тестов.

## Использование

### API

#### Получение баланса кошелька

- **URL**: `/api/v1/wallets/{walletId}`
- **Метод**: `GET`
- **Описание**: Получение баланса кошелька по его ID.
- **Аутентификация**: Требуется аутентификация. Пользователь должен иметь роль `ROLE_ADMIN` или быть владельцем кошелька.
- **Пример запроса**:

    ```sh
    curl -u admin\:password -X GET http://localhost:8080/api/v1/wallets/123e4567-e89b-12d3-a456-426614174000/balance
    ```

- **Пример ответа**:

    ```json
    {
        "success": true,
        "data": 1000
    }
    ```

#### Обновление кошелька

- **URL**: `/api/v1/wallets`
- **Метод**: `POST`
- **Описание**: Обновление баланса кошелька.
- **Аутентификация**: Требуется аутентификация. Пользователь должен иметь роль `ROLE_ADMIN` или быть владельцем кошелька.
- **Пример запроса**:

    ```sh
    curl -u admin\:password -X POST http://localhost:8080/api/v1/wallets -H "Content-Type: application/json" -d '{"walletId":"123e4567-e89b-12d3-a456-426614174000","operationType":"DEPOSIT","amount":1000}'
    ```

- **Пример ответа**:

    ```json
    {
        "success": true,
        "message": "Success"
    }
    ```
